# API для многопользовательского сервиса хранения заметок.

Заметка — это текстовое поле, длиной до 1000 символов. Заметок у пользователя может быть неограниченное количество. Заметки принадлежат конкретному пользователю, который их создал. Их можно создавать, редактировать, удалять. У заметок надо хранить дату создания и изменения. Пользователь может расшарить конкретную заметку с доступом по ссылке (как в яндекс-диске, гугл-доке и т. п.) для любого неавторизованного пользователя, но только на чтение.

Пользователь характеризуется логином и паролем. Нужно реализовать регистрацию пользователя и авторизацию. Доступ к методам апи должен осуществляться по токену (конкретную реализацию выбираете сами), срок жизни токена должен быть ограничен.

## Запуск

Работает с СУБД MySQL

Перед запуском необходимо создать базу MySQL и в корне приложения .env файл со следующими параметрами:

>DB_NAME - имя БД (notes)
> 
>DB_USER - пользователь БД - (root)
> 
>DB_PASSWORD - пароль от БД - (****)
> 
>DB_HOST - хост БД (127.0.0.1)
> 
>TOKEN_SECRET - секретная последовательность для генерации JWT токенов (0000000000000000000000)

чтобы создать в БД необходисые таблицы - нужно запустить 

>npm run migrate

## Запросы

- Регистрация пользователя

>POST /api/v1/registry
> 
> тело запроса: login, password - не менее 5 символов

- Авторизация пользователя

>POST /api/v1/login
> 
> тело запроса: login, password
> 
> Вслучае успешного выполнения возвращает JWT токен, который в последующих запросах 
> необходимо прикреплять в 
> http заголовок (auth-token)

- Разлогин пользователя со сбросом всех сессий пользователя (***требут токен***)

>POST /api/v1/logout

- Удаление пользователя (***требут токен***)

>DELETE /api/v1/user
> 

- Создание заметки (***требут токен***)
> POST /api/v1/note
> тело запроса: text - не может быть пустым

- Получение списка заметок (***требут токен***)
> GET /api/v1/note
> параметры:
> limit (необязательный) - кол-во заметок, 
> offset (необязательный) - смещение относительно начала списка (список сортирован по дате изменения)

- Просмотр конкретной заметки (***требут токен***)
>GET /api/v1/note/:id
> 
- Редактирование заметки (***требут токен***)
> PUT /api/v1/note/:id
> тело запроса: text - не может быть пустым

- Удаление заметки (***требут токен***)
> DELETE /api/v1/note/:id

- Расшаривание заметки для неавторизованного пользователя (***требут токен***)
> POST /api/v1/note/:id/share - где id - это id заметки
> В ответ приходит ссылка, по которой можно просмотреть данную заметку (без авторизационного токена)

- Отображение текста заметки неавторизованному пользователю по ссылке
> GET /api/v1/ + (ссылка, полученная из предыдущего запроса)

- Прекращение доступа к расшаренной заметке (***требут токен***)
> DELETE /api/v1/note/:id/share - где id - это id заметки